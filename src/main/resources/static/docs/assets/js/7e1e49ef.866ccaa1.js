"use strict";(self.webpackChunkclias_docs=self.webpackChunkclias_docs||[]).push([[7793],{6130:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"dev/frontend_app/arquitectura_general","title":"App M\xf3vil SISA - Arquitectura General","description":"Esta secci\xf3n describe c\xf3mo est\xe1 organizada la _app_ m\xf3vil SISA a nivel de capas, m\xf3dulos y flujos internos, y c\xf3mo se integra con los servicios de backend y con Firebase Cloud Messaging (FCM) para notificaciones. El foco es la aplicaci\xf3n m\xf3vil; se citan componentes del backend solo cuando es imprescindible para entender la integraci\xf3n.","source":"@site/docs/dev/frontend_app/arquitectura_general.md","sourceDirName":"dev/frontend_app","slug":"/dev/frontend_app/arquitectura_general","permalink":"/docs/dev/frontend_app/arquitectura_general","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"App M\xf3vil SISA - Arquitectura General","sidebar_label":"Arquitectura General","sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Introducci\xf3n","permalink":"/docs/dev/frontend_app/introduccion_sisa"},"next":{"title":"M\xf3dulos Principales","permalink":"/docs/dev/frontend_app/modulos_principales"}}');var s=i(4848),r=i(8453),l=i(6406);const c={title:"App M\xf3vil SISA - Arquitectura General",sidebar_label:"Arquitectura General",sidebar_position:1},d="Arquitectura General",t={},o=[{value:"Vista de Alto Nivel (App \u2013 Servicios \u2013 Backend)",id:"vista-de-alto-nivel-app--servicios--backend",level:2},{value:"Relaci\xf3n entre las capas en la Vista de Alto Nivel",id:"relaci\xf3n-entre-las-capas-en-la-vista-de-alto-nivel",level:3},{value:"Arquitectura Interna de la App (capas y m\xf3dulos)",id:"arquitectura-interna-de-la-app-capas-y-m\xf3dulos",level:2},{value:"Estrategia <em>Offline-First</em> y Manejo de Errores",id:"estrategia-offline-first-y-manejo-de-errores",level:2},{value:"Flujo de Notificaciones Push en SISA",id:"flujo-de-notificaciones-push-en-sisa",level:3},{value:"Relaci\xf3n con el Modelo de Datos",id:"relaci\xf3n-con-el-modelo-de-datos",level:2},{value:"Consideraciones de Dise\xf1o",id:"consideraciones-de-dise\xf1o",level:2},{value:"Vista general del \xe1rbol <code>lib/</code>",id:"vista-general-del-\xe1rbol-lib",level:2},{value:"6.2 Detalle de <code>lib/service/</code>",id:"62-detalle-de-libservice",level:2},{value:"6.3 Detalle de <code>lib/view/</code>",id:"63-detalle-de-libview",level:2},{value:"\xbfQu\xe9 sigue?",id:"qu\xe9-sigue",level:3}];function u(e){const n={blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"arquitectura-general",children:"Arquitectura General"})}),"\n",(0,s.jsxs)(n.p,{children:["Esta secci\xf3n describe ",(0,s.jsxs)(n.strong,{children:["c\xf3mo est\xe1 organizada la ",(0,s.jsx)(n.em,{children:"app"})," m\xf3vil SISA"]})," a nivel de capas, m\xf3dulos y flujos internos, y ",(0,s.jsx)(n.strong,{children:"c\xf3mo se integra"})," con los servicios de backend y con ",(0,s.jsx)(n.strong,{children:"Firebase Cloud Messaging (FCM)"})," para notificaciones. El foco es la ",(0,s.jsx)(n.strong,{children:"aplicaci\xf3n m\xf3vil"}),"; se citan componentes del backend solo cuando es imprescindible para entender la integraci\xf3n."]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["Nota: La documentaci\xf3n en ingl\xe9s (DeepWiki \u2013 ",(0,s.jsx)(n.em,{children:"TelemedicinaApp"}),") es de referencia y no siempre refleja los m\xf3dulos m\xe1s recientes. Aqu\xed se presenta la ",(0,s.jsx)(n.strong,{children:"versi\xf3n actualizada"})," aplicada a SISA."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"vista-de-alto-nivel-app--servicios--backend",children:"Vista de Alto Nivel (App \u2013 Servicios \u2013 Backend)"}),"\n",(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",margin:"12px 0"},children:(0,s.jsx)("div",{style:{transform:"scale(0.85)",transformOrigin:"top center"},children:(0,s.jsx)(l.A,{value:'%%{init:{ "flowchart": { "useMaxWidth": false } }}%%\nflowchart TB\nsubgraph APP[App Movil SISA - Flutter]\n\n  UI["Capa de Presentacion<br/>(Pantallas, Widgets)"] --\x3e ST["Gestion de Estado"]\n  ST --\x3e SVC["Servicios (service/*.dart)"]\n  SVC --\x3e STORE["Almacenamiento Local<br/>(SecureStorage, Cache)"]\n  SVC --\x3e HTTP["Cliente HTTP (Dio)"]\n\nend\n\nHTTP -- REST/JSON --\x3e BE[(Backend CLIAS)]\nBE --- DB[(Base de Datos)]\n\nsubgraph FCM[Firebase Cloud Messaging]\n  TOPIC["Topics / Tokens"]\nend\n\nBE -- envia notificaciones --\x3e FCM\nFCM -- push (OS) --\x3e APP\nAPP -- maneja --\x3e HNDL[firebase_messaging_handler]\n'})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Claves de la vista:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["La ",(0,s.jsx)(n.em,{children:"app"})," est\xe1 organizada en ",(0,s.jsx)(n.strong,{children:"Presentaci\xf3n \u2192 Estado \u2192 Servicios \u2192 Almacenamiento/HTTP"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Los ",(0,s.jsx)(n.strong,{children:"Servicios"})," encapsulan la comunicaci\xf3n con el backend y la gesti\xf3n local (segura y cach\xe9)."]}),"\n",(0,s.jsxs)(n.li,{children:["Las ",(0,s.jsx)(n.strong,{children:"notificaciones"})," se env\xedan desde el backend a ",(0,s.jsx)(n.strong,{children:"FCM"}),", y el dispositivo las recibe a trav\xe9s del ",(0,s.jsx)(n.strong,{children:"handler"})," nativo/Flutter."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"relaci\xf3n-entre-las-capas-en-la-vista-de-alto-nivel",children:"Relaci\xf3n entre las capas en la Vista de Alto Nivel"}),"\n",(0,s.jsx)(n.p,{children:"En el diagrama de arquitectura se distinguen tres niveles principales dentro de la aplicaci\xf3n:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Capa de Presentaci\xf3n (Pantallas, Widgets)"}),(0,s.jsx)(n.br,{}),"\n","Se encarga \xfanicamente de mostrar los datos al usuario y de recolectar sus interacciones.",(0,s.jsx)(n.br,{}),"\n","Ejemplos: pantalla de login, formularios de encuestas, dashboard de resultados."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Gesti\xf3n de Estado"}),(0,s.jsx)(n.br,{}),"\n","Representa la capa intermedia donde se mantiene la informaci\xf3n viva de la aplicaci\xf3n.",(0,s.jsx)(n.br,{}),"\n","Aqu\xed se conserva y actualiza el estado actual de la app, como:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Usuario autenticado."}),"\n",(0,s.jsx)(n.li,{children:"Notificaciones disponibles."}),"\n",(0,s.jsx)(n.li,{children:"Encuestas pendientes de env\xedo."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["En ",(0,s.jsx)(n.strong,{children:"SISA"}),", un ejemplo concreto es el archivo ",(0,s.jsx)(n.code,{children:"notification_state.dart"}),", que administra el estado de las notificaciones recibidas y asegura que la interfaz se actualice en tiempo real."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["Servicios (",(0,s.jsx)(n.code,{children:"service/*.dart"}),")"]}),(0,s.jsx)(n.br,{}),"\n","Son responsables de ejecutar la l\xf3gica \u201cexterna\u201d:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Comunicarse con el backend v\xeda API REST (con el cliente ",(0,s.jsx)(n.code,{children:"Dio"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:["Guardar y recuperar datos en ",(0,s.jsx)(n.code,{children:"SecureStorage"})," o en cach\xe9."]}),"\n",(0,s.jsxs)(n.li,{children:["Registrar y manejar el token en ",(0,s.jsx)(n.strong,{children:"Firebase Cloud Messaging (FCM)"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["\ud83d\udd11 ",(0,s.jsx)(n.strong,{children:"Nota:"})," La \u201cGesti\xf3n de Estado\u201d no corresponde a un archivo espec\xedfico, sino a un ",(0,s.jsx)(n.strong,{children:"patr\xf3n de dise\xf1o"})," que organiza c\xf3mo la UI interact\xfaa con los servicios. De esta forma, se asegura que la app permanezca coherente, extensible y preparada para manejar conectividad limitada."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"arquitectura-interna-de-la-app-capas-y-m\xf3dulos",children:"Arquitectura Interna de la App (capas y m\xf3dulos)"}),"\n",(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",margin:"12px 0"},children:(0,s.jsx)("div",{style:{transform:"scale(0.85)",transformOrigin:"top center"},children:(0,s.jsx)(l.A,{value:'%%{init:{ "flowchart": { "useMaxWidth": false } }}%%\nflowchart TB\nsubgraph UI[Presentaci\xf3n]\n  VIEWS["Screens & Widgets<br/>(Login, Dashboard, Chat, Formularios, Resultados, Mapas)"]\nend\n\nsubgraph STATE[Gesti\xf3n de Estado]\n  STATE_CORE["Controladores / Providers"]\n  NOTI_STATE["notification_state.dart"]\nend\n\nSVC["Servicios:<br/>- auth_service.dart<br/>- paciente_service.dart<br/>- chat_service.dart<br/>- sesion_chat_service.dart<br/>- encuesta_service.dart<br/>- inf_socioeconomica_service.dart<br/>- resultado_service.dart<br/>- archivo_service.dart<br/>- resource_service.dart<br/>- ubicacion_service.dart<br/>- notification_service.dart<br/>- firebase_messaging_handler.dart<br/>- connectivity_service.dart"]\n\nsubgraph DATA[Datos & Conectividad]\n  STORE["SecureStorage / Cache"]\n  HTTP["Dio (REST/JSON)"]\nend\n\nVIEWS --\x3e STATE_CORE\nSTATE_CORE --\x3e SVC\nSVC --\x3e STORE\nSVC --\x3e HTTP\n\nSVC --\x3e NOTI_STATE\nNOTI_STATE --\x3e VIEWS\n'})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Ideas clave:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Los servicios est\xe1n ",(0,s.jsx)(n.strong,{children:"desacoplados"})," de la UI y de la gesti\xf3n de estado."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"connectivity_service.dart"})," define el ",(0,s.jsx)(n.strong,{children:"comportamiento offline-first"})," (validar conexi\xf3n antes de llamar al backend y sincronizar cuando vuelve internet)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"firebase_messaging_handler.dart"})," + ",(0,s.jsx)(n.code,{children:"notification_state.dart"})," gobiernan el ",(0,s.jsx)(n.strong,{children:"ciclo de vida de notificaciones"})," (foreground/background/taps)."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h2,{id:"estrategia-offline-first-y-manejo-de-errores",children:["Estrategia ",(0,s.jsx)(n.em,{children:"Offline-First"})," y Manejo de Errores"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Verificaci\xf3n de conectividad:"})," antes de cualquier operaci\xf3n de red, la app consulta ",(0,s.jsx)(n.code,{children:"connectivity_service.dart"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Almacenamiento temporal/local:"})," formularios, encuestas y datos sensibles se guardan en ",(0,s.jsx)(n.code,{children:"SecureStorage"}),"/cach\xe9 hasta su sincronizaci\xf3n."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Sincronizaci\xf3n diferida:"})," cuando vuelve la conectividad, los servicios ",(0,s.jsx)(n.strong,{children:"reintentan"})," el env\xedo/actualizaci\xf3n."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Manejo de errores:"})," estandarizar respuestas (timeouts, 401/403, 5xx) mostrando mensajes \xfatiles y, en caso de 401/403, ",(0,s.jsx)(n.strong,{children:"limpieza de sesi\xf3n y redirecci\xf3n a Login"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Diagrama de Secuencia \u2014 Inicio de Sesi\xf3n y Registro de Token FCM"})}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n  participant UI as Pantalla Login\n  participant SVC as AuthService (Dio)\n  participant BE as Backend\n  participant ST as SecureStorage\n  participant FCM as NotificationService\n\n  UI->>SVC: login(usuario, clave, appVersion)\n  SVC->>BE: POST /usuarios/autenticar\n  BE--\x3e>SVC: 200 { publicId, token, dispositivo, ... }\n  SVC->>ST: guardar user_id, token, device_id, flags\n  SVC->>FCM: registrarTokenFCM(publicId)\n  SVC--\x3e>UI: UserResponse (\xe9xito)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Diagrama de Secuencia \u2014 Operaci\xf3n Offline con Sincronizaci\xf3n Posterior"})}),"\n",(0,s.jsx)(n.mermaid,{value:'sequenceDiagram\n  participant UI as Formulario (Encuesta)\n  participant SVC as EncuestaService\n  participant CON as ConnectivityService\n  participant ST as SecureStorage/Cache\n  participant BE as Backend\n\n  UI->>SVC: enviarEncuesta(datos)\n  SVC->>CON: hasInternetConnection?\n  alt Sin conexi\xf3n\n    SVC->>ST: persistir borrador / cola de sincronizaci\xf3n\n    SVC--\x3e>UI: "Guardado localmente"\n  else Con conexi\xf3n\n    SVC->>BE: POST /encuestas\n    BE--\x3e>SVC: 200 { id, estado }\n    SVC--\x3e>UI: "Enviado"\n  end\n\n  Note over CON,BE: Cuando vuelve internet, el servicio procesa la cola<br/>y sincroniza los env\xedos pendientes.'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Diagrama de Flujo \u2014 Notificaciones Push"})}),"\n",(0,s.jsx)(n.h3,{id:"flujo-de-notificaciones-push-en-sisa",children:"Flujo de Notificaciones Push en SISA"}),"\n",(0,s.jsx)(n.p,{children:"El siguiente diagrama describe c\xf3mo viaja una notificaci\xf3n desde el backend hasta la interfaz del usuario en la app m\xf3vil:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Backend CLIAS"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"El servidor genera un evento (ej. resultado disponible, recordatorio)."}),"\n",(0,s.jsxs)(n.li,{children:["Env\xeda una notificaci\xf3n estructurada hacia ",(0,s.jsx)(n.strong,{children:"Firebase Cloud Messaging (FCM)"}),", incluyendo el ",(0,s.jsx)(n.code,{children:"token"})," del dispositivo o el ",(0,s.jsx)(n.code,{children:"topic"})," correspondiente."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Firebase Cloud Messaging (FCM)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Act\xfaa como intermediario en la nube."}),"\n",(0,s.jsx)(n.li,{children:"Recibe la notificaci\xf3n y la direcciona al sistema operativo del dispositivo registrado."}),"\n",(0,s.jsx)(n.li,{children:"Garantiza la entrega incluso si la app est\xe1 en segundo plano."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Sistema Operativo del Dispositivo (Android/iOS)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Recibe el push y lo despacha a la aplicaci\xf3n asociada."}),"\n",(0,s.jsx)(n.li,{children:"Si la app est\xe1 cerrada, muestra una notificaci\xf3n nativa en la bandeja del sistema."}),"\n",(0,s.jsx)(n.li,{children:"Si est\xe1 abierta, env\xeda el evento directamente a la app."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"App SISA"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Capta la notificaci\xf3n y la deriva al ",(0,s.jsx)(n.strong,{children:"handler"})," definido en Flutter."]}),"\n",(0,s.jsx)(n.li,{children:"Aqu\xed se decide si la notificaci\xf3n se muestra como banner emergente, badge o redirecci\xf3n autom\xe1tica."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"firebase_messaging_handler.dart"})})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Gestiona la l\xf3gica de recepci\xf3n del mensaje."}),"\n",(0,s.jsxs)(n.li,{children:["Diferencia entre notificaci\xf3n en ",(0,s.jsx)(n.strong,{children:"foreground"})," (app abierta), ",(0,s.jsx)(n.strong,{children:"background"})," o ",(0,s.jsx)(n.strong,{children:"terminated"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Estandariza los datos recibidos antes de pasarlos al estado global."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"notification_state.dart"})})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Mantiene el estado actualizado de las notificaciones dentro de la app."}),"\n",(0,s.jsx)(n.li,{children:"Permite que la interfaz se reactive autom\xe1ticamente cuando llega una nueva alerta."}),"\n",(0,s.jsx)(n.li,{children:"Aqu\xed se administran tambi\xe9n notificaciones le\xeddas/no le\xeddas."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Pantallas / Widgets (UI)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Finalmente, la informaci\xf3n se refleja al usuario:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Banners"}),": mensajes visibles en la parte superior de la app."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Badges"}),": indicadores de cantidad de notificaciones pendientes."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Rutas"}),": redirecci\xf3n autom\xe1tica a la pantalla relevante (ej. ver resultado)."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["\ud83d\udd11 ",(0,s.jsx)(n.strong,{children:"Idea central:"}),(0,s.jsx)(n.br,{}),"\n","El flujo garantiza que ",(0,s.jsx)(n.strong,{children:"todas las notificaciones viajen desde el backend hasta el usuario final"}),", independientemente del estado de la aplicaci\xf3n (abierta, minimizada o cerrada)."]}),"\n",(0,s.jsx)(n.mermaid,{value:'flowchart LR\n  BE[Backend CLIAS] --\x3e|env\xeda| FCM[Firebase Cloud Messaging]\n  FCM --\x3e|push| OS["Sistema Operativo del dispositivo"]\n  OS --\x3e APP["App SISA"]\n  APP --\x3e HNDL["firebase_messaging_handler.dart"]\n  HNDL --\x3e NST["notification_state.dart"]\n  NST --\x3e UI["Pantallas / Widgets<br/>(banners, badges, rutas)"]\n'}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"relaci\xf3n-con-el-modelo-de-datos",children:"Relaci\xf3n con el Modelo de Datos"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["La app ",(0,s.jsx)(n.strong,{children:"consume/produce"})," entidades que se corresponden con el ",(0,s.jsx)(n.strong,{children:"modelo de datos del backend"})," (ERD actualizado)."]}),"\n",(0,s.jsxs)(n.li,{children:["Desde la app se gestionan: ",(0,s.jsx)(n.strong,{children:"Paciente, CuentaUsuario, Dispositivo, Sesi\xf3n de Chat, Ex\xe1menes/Resultados, Archivos"}),", entre otros."]}),"\n",(0,s.jsxs)(n.li,{children:["La app no accede directamente a la base de datos; opera mediante ",(0,s.jsx)(n.strong,{children:"APIs REST"})," y mapea las respuestas a ",(0,s.jsx)(n.strong,{children:"modelos locales"})," para persistencia temporal y renderizado en UI."]}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["El diagrama ERD de referencia es provisto por el equipo de backend y ",(0,s.jsx)(n.strong,{children:"se mantiene fuera"})," de esta documentaci\xf3n (que se centra en el cliente m\xf3vil)."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"consideraciones-de-dise\xf1o",children:"Consideraciones de Dise\xf1o"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Modularidad:"})," cada servicio encapsula una funcionalidad del dominio (auth, chat, encuestas, socioecon\xf3mico, resultados, archivos, ubicaci\xf3n, notificaciones)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Trazabilidad:"})," logs consistentes (errores y eventos clave) facilitan soporte y auditor\xeda."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Extensibilidad:"})," nuevos formularios o flujos reutilizan la misma ruta: UI \u2192 Estado \u2192 Servicio \u2192 Almacenamiento/HTTP \u2192 Backend."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Seguridad:"})," uso de ",(0,s.jsx)(n.strong,{children:"JWT"})," en cabeceras, almacenamiento m\xednimo en dispositivo y respeto de pol\xedticas de privacidad (ver cap\xedtulo ",(0,s.jsx)(n.em,{children:"Seguridad y Privacidad"}),")."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h1,{id:"estructura-de-directorios-gu\xeda-general",children:"Estructura de Directorios (gu\xeda general)"}),"\n",(0,s.jsxs)(n.p,{children:["La aplicaci\xf3n SISA mantiene una estructura modular dentro de la carpeta ",(0,s.jsx)(n.code,{children:"lib/"}),".",(0,s.jsx)(n.br,{}),"\n","Para una mejor comprensi\xf3n, la estructura se divide en vistas generales y detalles por carpeta."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h2,{id:"vista-general-del-\xe1rbol-lib",children:["Vista general del \xe1rbol ",(0,s.jsx)(n.code,{children:"lib/"})]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Panorama r\xe1pido para ubicar carpetas principales."}),"\n"]}),"\n",(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",margin:"10px 0"},children:(0,s.jsx)("div",{style:{transform:"scale(0.9)",transformOrigin:"top center",maxWidth:980},children:(0,s.jsx)(l.A,{value:'%%{init:{ "flowchart": { "useMaxWidth": false } }}%%\nflowchart TB\nMAIN["lib/main.dart"]\nVIEW["lib/view"]\nSERVICE["lib/service"]\nMODEL["lib/model"]\nUTILS["lib/utils"]\nSTORAGE["lib/storage"]\n\nMAIN --\x3e VIEW\nMAIN --\x3e SERVICE\nMAIN --\x3e MODEL\nMAIN --\x3e UTILS\nMODEL --\x3e STORAGE\n'})})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h2,{id:"62-detalle-de-libservice",children:["6.2 Detalle de ",(0,s.jsx)(n.code,{children:"lib/service/"})]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["Servicios agrupados por ",(0,s.jsx)(n.strong,{children:"dominio"})," para compresi\xf3n visual."]}),"\n"]}),"\n",(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",margin:"10px 0"},children:(0,s.jsx)("div",{style:{transform:"scale(0.85)",transformOrigin:"top center",maxWidth:980},children:(0,s.jsx)(l.A,{value:'%%{init:{ "flowchart": { "useMaxWidth": false } }}%%\nflowchart LR\nsubgraph SERVICE["lib/service"]\n  direction LR\n\n  subgraph CORE["Autenticaci\xf3n / N\xfacleo"]\n    direction TB\n    AUTH["auth_service.dart"]\n    PAC["paciente_service.dart"]\n    RES["resultado_service.dart"]\n  end\n\n  subgraph INTERACT["Interacci\xf3n"]\n    direction TB\n    CHAT["chat_service.dart"]\n    SESION["sesion_chat_service.dart"]\n  end\n\n  subgraph PUSH["Notificaciones"]\n    direction TB\n    NOTI["notification_service.dart"]\n    FCM_H["firebase_messaging_handler.dart"]\n  end\n\n  subgraph FORMS["Formularios"]\n    direction TB\n    ENC["encuesta_service.dart"]\n    SOCIO["inf_socioeconomica_service.dart"]\n  end\n\n  subgraph UTILS["Utilitarios"]\n    direction TB\n    LOC["ubicacion_service.dart"]\n    FILES["archivo_service.dart"]\n    RESRC["resource_service.dart"]\n    CONN["connectivity_service.dart"]\n  end\nend\n\n'})})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h2,{id:"63-detalle-de-libview",children:["6.3 Detalle de ",(0,s.jsx)(n.code,{children:"lib/view/"})]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Estructura sugerida de pantallas y componentes reutilizables."}),"\n"]}),"\n",(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",margin:"10px 0"},children:(0,s.jsx)("div",{style:{transform:"scale(0.9)",transformOrigin:"top center",maxWidth:980},children:(0,s.jsx)(l.A,{value:'%%{init:{ "flowchart": { "useMaxWidth": false } }}%%\nflowchart TB\nsubgraph VIEW["lib/view"]\n  direction TB\n  SCREENS["screens/<br/>(login, dashboard, chat, formularios, resultados, mapas)"]\n  WIDGETS["widgets/<br/>(componentes reutilizables)"]\nend\n'})})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"qu\xe9-sigue",children:"\xbfQu\xe9 sigue?"}),"\n",(0,s.jsxs)(n.p,{children:["En los siguientes cap\xedtulos se detallan ",(0,s.jsx)(n.strong,{children:"M\xf3dulos Principales"}),", ",(0,s.jsx)(n.strong,{children:"Servicios y APIs"}),", y ",(0,s.jsx)(n.strong,{children:"Conectividad/Offline"}),", reutilizando los diagramas y convenciones presentadas en esta arquitectura."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}}}]);